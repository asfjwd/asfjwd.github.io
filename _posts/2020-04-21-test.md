---
layout: post
title: test
---

#### Notations : 

-   $$\left[P\right] = 1$, if $P$$ is true. Otherwise
    $\left[P\right] = 0$.\

-   $S_{k}(n) = \mathlarger{\sum_{i = 0}^{n} i^{k}}$

#### Problem 0 : 

Given $a, b, c, n$, compute
$\mathlarger{\sum_{x = 0}^{n}} \floor*{\
frac{ax + b}{c}}$.

#### Solution : 

Let us denote
$f(a, b, c, n) = \mathlarger{\sum_{x = 0}^{n}} \floor*{\frac{ax + b}{c}}$
Consider the case when $a  \geq c$ or $ b \geq  c$. Then we have,

$$\begin{aligned}
 f(a, b, c, n) = &
\mathlarger{\sum_{x = 0}^{n}} \floor*{\frac{ ( \floor*{\frac{a}{c}}c + (a \bmod c) )x + \floor*{\frac{b}{c}}c + (b \bmod c)}{c}} \\ =&
\mathlarger{\sum_{x = 0}^{n}} \floor*{\frac{a}{c}}x + \floor*{\frac{b}{c}} +  \floor*{\frac{ (a \bmod c)x + (b \bmod c)}{c}} \\ =&
\frac{n(n + 1)}{2} + (n + 1)\floor*{\frac{b}{c}} + f(a \bmod c, b \bmod c, c, n)\end{aligned}$$

Now we just need to find $f(a, b, c, n)$ when $a < c$ and $b < c$.\
We have,
$$f(a, b, c, n) = \mathlarger{\sum_{x = 0}^{n}} \floor*{\frac{ax + b}{c}}$$
We can also write it like this,

$$\begin{aligned}
f(a, b, c, n) =& \mathlarger{\sum_{x = 0}^{n} \sum_{y = 0}^{ \floor*{\frac{ax + b}{c}} - 1}} 1 \\ =&
\mathlarger{\sum_{y = 0}^{ \floor*{\frac{an + b}{c}} - 1} \sum_{x = 0}^{n}}\left[y < \floor*{\frac{ax + b}{c}} \right]\end{aligned}$$

Now,
$$y < \floor*{\dfrac{ax + b}{c}} \implies y + 1 \leq \dfrac{ax + b}{c} \implies yc + c - b < ax \implies yc + c - b - 1 < ax
\implies \floor*{\dfrac{yc + c -b - 1}{a}} < x$$ Let $m = an + b$,\

$$\begin{aligned}
f(a, b, c, n) =& \mathlarger{\sum_{y = 0}^{m - 1} \sum_{x = 0}^{n}}\left[x > \floor*{\dfrac{yc + c -b - 1}{a}}\right] \\ =&
\mathlarger{\sum_{y = 0}^{m - 1}} n - \floor*{\dfrac{yc + c -b - 1}{a}} \\ &=
nm - \mathlarger{\sum_{y = 0}^{m - 1}}\floor*{\dfrac{yc + c -b - 1}{a}} \\ &=
nm - f(c, c - b - 1, a, m - 1)\end{aligned}$$

Thus we have obtained a recursive formula for our function. For any
state where $a < c$ and $b < c$, $a$ and $c$ change their positions in
the next state and the process repeats. Otherwise we make a and b
smaller than c by taking the remainder. This process is similar to the
Euclidean algorithm.

#### Complexity : 

$\mathcal{O}(log(a))$

#### Implementation :

#### Problem 1 :

Given $a, b, c, n$ compute
$\mathlarger{\sum_{x = 0}^{n}} x\floor*{\frac{ax + b}{c}}$ and
$\mathlarger{\sum_{x = 0}^{n}} \floor*{\frac{ax + b}{c}}^{2}$.\

#### Solution :

Let
$g(a, b, c, n) = \mathlarger{\sum_{x = 0}^{n}} x\floor*{\frac{ax + b}{c}}$
and
$h(a, b, c, n) = \mathlarger{\sum_{x = 0}^{n}} \floor*{\frac{ax + b}{c}}^{2}$\
We will proceed similarly to our previous problem.\

#### Deriving g :\

-   When $a \geq c$ or $b \geq c$:

    $$\begin{aligned}
     g(a, b, c, n) = &
    \mathlarger{\sum_{x = 0}^{n}} x\floor*{\frac{ ( \floor*{\frac{a}{c}}c + (a \bmod c) )x + \floor*{\frac{b}{c}}c + (b \bmod c)}{c}} \\ =&
    \mathlarger{\sum_{x = 0}^{n}} \floor*{\frac{a}{c}}x^{2} + \floor*{\frac{b}{c}}x +  x\floor*{\frac{ (a \bmod c)x + (b \bmod c)}{c}} \\ =&
    \frac{n(n + 1)(2n + 1)}{6} + \frac{n(n + 1)}{2}\floor*{\frac{b}{c}} + g(a \bmod c, b \bmod c, c, n)\end{aligned}$$

-   When $a < c$ and $b < c$:

    $$\begin{aligned}
    g(a, b, c, n) =& \mathlarger{\sum_{x = 0}^{n} x\sum_{y = 0}^{ \floor*{\frac{ax + b}{c}} - 1}} 1 \\ =&
    \mathlarger{\sum_{y = 0}^{ \floor*{\frac{an + b}{c}} - 1} \sum_{x = 0}^{n}}\left[y < \floor*{\frac{ax + b}{c}} \right]x \\ =& 
    \mathlarger{\sum_{y = 0}^{m - 1} \sum_{x = 0}^{n}}\left[x > \floor*{\dfrac{yc + c -b - 1}{a}}\right]x \end{aligned}$$

    Let $z = \floor*{\dfrac{yc + c -b - 1}{a}},$

    $$\begin{aligned}
    g(a, b, c, n) =& \mathlarger{\sum_{y = 0}^{m - 1} \sum_{x = 0}^{n}}\left[x > k\right]x \\ =&
    \mathlarger{\sum_{y = 0}^{m - 1}} {(z + 1) + (z + 2) \ldots (z + (n - z))} \\ =&
    \mathlarger{\sum_{y = 0}^{m - 1}} {(n + z + 1)(n - z)} \\ =&
    \mathlarger{\sum_{y = 0}^{m - 1}} { n(n + 1) -z -z^{2}} \\ =&
    mn(n + 1) - \left(\mathlarger{\sum_{y = 0}^{m - 1}} {z}\right) - \left(\mathlarger{\sum_{y = 0}^{m - 1}} {z^{2}}\right)\\ =&
    mn(n + 1) - \left(\mathlarger{\sum_{y = 0}^{m - 1}} {\floor*{\dfrac{yc + c -b - 1}{a}}}\right) - \left(\mathlarger{\sum_{y = 0}^{m - 1}} {\floor*{\dfrac{yc + c -b - 1}{a}}^{2}}\right)\\ =&
    mn(n + 1) - f(c, c - b - 1, a, m - 1) - h(c, c - b - 1, a, m - 1)\end{aligned}$$

#### Deriving h :\

-   When $a \geq c$ or $b \geq c$:

    $$\begin{aligned}
     h(a, b, c, n) = &
    \mathlarger{\sum_{x = 0}^{n}} \floor*{\frac{ ( \floor*{\frac{a}{c}}c + (a \bmod c) )x + \floor*{\frac{b}{c}}c + (b \bmod c)}{c}}^{2}\\ =&
    \mathlarger{\sum_{x = 0}^{n}} \left(\floor*{\frac{a}{c}}x + \floor*{\frac{b}{c}} +  \floor*{\frac{ (a \bmod c)x + (b \bmod c)}{c}}\right)^{2}\\ =&
    \mathlarger{\sum_{x = 0}^{n}} \floor*{\frac{a}{c}}^{2}x^{2} + \floor*{\frac{b}{c}}^{2} +  \floor*{\frac{ (a \bmod c)x + (b \bmod c)}{c}}^{2} + 2\floor*{\frac{a}{c}}\floor*{\frac{b}{c}}x +\\& 2\floor*{\frac{b}{c}}\floor*{\frac{ (a \bmod c)x + (b \bmod c)}{c}} + \floor*{\frac{a}{c}}x\floor*{\frac{ (a \bmod c)x + (b \bmod c)}{c}}\\ =&
    \frac{n(n + 1)(2n + 1)}{6}\floor*{\frac{a}{c}}^{2} + (n + 1)\floor*{\frac{b}{c}}^{2} + n(n + 1)\floor*{\frac{a}{c}}\floor*{\frac{b}{c}} + \left(\mathlarger{\sum_{x = 0}^{n}}\floor*{\frac{ (a \bmod c)x + (b \bmod c)}{c}}^{2}\right) \\& + \left(2\floor*{\frac{b}{c}}\mathlarger{\sum_{x = 0}^{n}}\floor*{\frac{ (a \bmod c)x + (b \bmod c)}{c}}\right)
     + \left(2\floor*{\frac{a}{c}}\mathlarger{\sum_{x = 0}^{n}}x\floor*{\frac{ (a \bmod c)x + (b \bmod c)}{c}}\right) \\=&
    \frac{n(n + 1)(2n + 1)}{6}\floor*{\frac{a}{c}}^{2} + (n + 1)\floor*{\frac{b}{c}}^{2} + n(n + 1)\floor*{\frac{a}{c}}\floor*{\frac{b}{c}} + h(a \bmod c, b \bmod c, c, n) \\& + 2\floor*{\frac{b}{c}}f(a \bmod c, b \bmod c, c, n)
     + 2\floor*{\frac{a}{c}}g(a \bmod c, b \bmod c, c, n)\end{aligned}$$

-   When $a < c$ and $b < c$ :\
    \
    Working with the square term is not easy. So, lets break it down.
    $$n^2 = n(n + 1) - n = 2 \left(\sum_{i = 0}^{n - 1} i + 1\right) - n$$
    Using this we get,

    $$\begin{aligned}
    h(a, b, c, n) =& \mathlarger{\sum_{x = 0}^{n}} \floor*{\frac{ax + b}{c}}^{2}\\ =&
    \mathlarger{\sum_{x = 0}^{n}} 2\mathlarger{\left(\sum_{y = 0}^{\floor*{\frac{ax + b}{c}} - 1} y + 1\right)} - \floor*{\frac{ax + b}{c}}\\ =&
    2\mathlarger{\sum_{x = 0}^{n}\sum_{y = 0}^{m - 1}} (y + 1) - f(a, b, c, n) \end{aligned}$$

    Now,

    $$\begin{aligned}
    \mathlarger{\sum_{x = 0}^{n}\sum_{y = 0}^{m - 1} y + 1} &= \mathlarger{\sum_{y = 0}^{m - 1} (y + 1)\sum_{x = 0}^{n}} \left[ x > z \right]\\ &=
    \mathlarger{\sum_{y = 0}^{m - 1}} (y + 1) (n - z)\\ &=
    \left(\mathlarger{\sum_{y = 0}^{m - 1}}(y + 1)n\right) -\left(y\mathlarger{\sum_{y = 0}^{m - 1}}z\right) - \left(\mathlarger{\sum_{y = 0}^{m - 1}}z\right) \\ &=
    \frac{nm(m + 1)}{2} - g(c, c - b - 1, a, m - 1) - f(c, c - b - 1, a, m - 1)\end{aligned}$$

    Finally,
    $$h(a, b, c, n) = nm(m + 1) - 2g(c, c - b - 1, a, m - 1) - 2f(c, c - b - 1, a, m - 1) - f(a, b, c, n)$$

    #### Implementation : 

#### Problem 3:
